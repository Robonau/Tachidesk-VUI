import{r as a,P as v}from"./index.b35b6c87.js";const l=a(""),o=a(!1);let s=v.getItem("baseUrl");s=s==""?document.location.origin+document.location.pathname:s;const n=new URL(s);n.protocol=n.protocol=="https:"?"wss:":"ws:";let e;const i=r=>{l.value=r.data},c=()=>{console.log("Connected"),o.value=!0,e.addEventListener("message",i),e.addEventListener("close",t)},t=()=>{o.value=!1,e&&(console.error("Disconnected."),e.removeEventListener("message",i),e.removeEventListener("open",c),e.removeEventListener("close",t)),e=new WebSocket(`${n.href.slice(0,-1)}/api/v1/downloads`),e.addEventListener("open",c)};t();function u(){return{eventsFromServer:l,isConnected:o,sendMsg:d=>{e.send(d)}}}export{u};
