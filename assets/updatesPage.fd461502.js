import{u as I,a as x}from"./use-dark.1516cb7d.js";import{c as z,h as L}from"./QSpinner.cedf2831.js";import{c as y,h as N,g as T,f as w,r as g,_ as C,D as S,j as r,k as l,m as a,n as t,q as Q,t as v,aj as D,p as U,u as P,y as h,z as $,F as q,v as j}from"./index.b35b6c87.js";import{Q as d,a as m}from"./QItemLabel.f084a15e.js";import{Q as _}from"./QItem.624de6a8.js";import{Q as b}from"./QCard.70ae0f07.js";import{Q as A}from"./QInfiniteScroll.a7c6b959.js";import{Q as R}from"./QPage.32043b58.js";import{R as B}from"./Ripple.5f8954d8.js";import{Q as V}from"./QInnerLoading.950f1dd6.js";import{Q as F}from"./QImg.4c286d18.js";import{Q as O}from"./QBtn.c248b476.js";import{u as E}from"./use-quasar.9a62b4af.js";import{g as J}from"./usefull.e82e70c8.js";import"./dom.4a68f118.js";import"./scroll.fbb25234.js";import"./use-transition.6c02567b.js";import"./QIcon.ac005315.js";import"./fetcher.f8235356.js";const M=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],G=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var i=z({name:"QSkeleton",props:{...I,tag:{type:String,default:"div"},type:{type:String,validator:e=>M.includes(e),default:"rect"},animation:{type:String,validator:e=>G.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:n}){const s=T(),u=x(e,s.proxy.$q),c=y(()=>{const o=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:o[0],height:o[1]}}),p=y(()=>`q-skeleton q-skeleton--${u.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>N(e.tag,{class:p.value,style:c.value},L(n.default))}});const H=w({name:"UpdateCard",props:{item:{type:Object,required:!0}},methods:{async download(e){await this.$fetch(`/api/v1/download/${e.manga.id}/chapter/${e.chapter.index}`)}},mounted:function(){J(this.item.manga.thumbnailUrl+"?useCache="+this.useCache).then(e=>{this.imgdata=e})},setup(){const e=g(""),n=E();return{useCache:g(`${n.localStorage.getItem("useCache")}`),imgdata:e}}});function K(e,n,s,u,c,p){return S((r(),l(b,{clickable:"",dark:e.$q.dark.isActive,class:"q-pa-xs q-ma-sm"},{default:a(()=>[t(_,{to:"/manga/"+e.item.manga.id},{default:a(()=>[t(d,{avatar:""},{default:a(()=>[t(F,{src:e.imgdata,loading:"lazy","spinner-color":"white",style:{height:"93px","aspect-ratio":"225/350",width:"fit-content"},class:"rounded-borders items-center justify-center col-1","no-spinner":""},{default:a(()=>[t(V,{showing:!e.imgdata,color:"primary",style:{padding:"0"}},null,8,["showing"])]),_:1},8,["src"])]),_:1}),t(d,null,{default:a(()=>[t(m,null,{default:a(()=>[Q(v(e.item.manga.title),1)]),_:1}),t(m,{caption:""},{default:a(()=>[Q(v(e.item.chapter.name),1)]),_:1})]),_:1}),e.item.chapter.downloaded?U("",!0):(r(),l(O,{key:0,onClick:n[0]||(n[0]=D(o=>e.download(e.item),["prevent"])),round:"",style:{height:"fit-content"},flat:"",icon:"download",class:"flex-right self-center"}))]),_:1},8,["to"])]),_:1},8,["dark"])),[[B]])}var W=C(H,[["render",K]]);const X=w({name:"updatesPage",components:{UpdateCard:W},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},async onLoad(e,n){const s=await this.$fetchJSON(`/api/v1/update/recentChapters/${e}`);s.hasNextPage||this.$refs.infiniteScrol.stop(),this.updates.push(...s.page),n()}},setup(e,{emit:n}){return n("setTitle","Updates"),{updates:g([])}}});function Y(e,n,s,u,c,p){const o=P("UpdateCard");return r(),l(R,{"style-fn":e.myTweak},{default:a(()=>[t(A,{onLoad:e.onLoad,offset:e.$q.screen.height,ref:"infiniteScrol"},{loading:a(()=>[(r(),h(q,null,$(6,(k,f)=>j("div",{key:f},[S((r(),l(b,{clickable:"",dark:e.$q.dark.isActive,class:"q-pa-xs q-ma-sm"},{default:a(()=>[t(_,null,{default:a(()=>[t(d,{avatar:""},{default:a(()=>[t(i,{height:"93px",style:{height:"93px","aspect-ratio":"225/350"}})]),_:1}),t(d,null,{default:a(()=>[t(m,null,{default:a(()=>[t(i,{type:"text"})]),_:1}),t(m,{caption:""},{default:a(()=>[t(i,{type:"text"})]),_:1})]),_:1}),t(i,{class:"flex-right self-center",type:"circle"})]),_:1})]),_:1},8,["dark"])),[[B]])])),64))]),default:a(()=>[(r(!0),h(q,null,$(e.updates,(k,f)=>(r(),h("div",{key:f},[t(o,{item:k},null,8,["item"])]))),128))]),_:1},8,["onLoad","offset"])]),_:1},8,["style-fn"])}var ye=C(X,[["render",Y]]);export{ye as default};
