import{Q as _}from"./QIcon.ac005315.js";import{Q as h,a as N}from"./QItemLabel.f084a15e.js";import{Q as i}from"./QBtn.c248b476.js";import{Q as f}from"./QItem.624de6a8.js";import{Q as I}from"./QList.53b7cd17.js";import{Q as U}from"./QPageSticky.15c3cd3b.js";import{Q as y}from"./QCardSection.42fc0f1a.js";import{Q as k}from"./QInput.a9b5ac3c.js";import{Q as C}from"./QToggle.6707944d.js";import{Q}from"./QCardActions.ed0a9806.js";import{Q as $}from"./QCard.70ae0f07.js";import{Q as b}from"./QDialog.476c5919.js";import{Q as B}from"./QPage.32043b58.js";import{C as w}from"./ClosePopup.57ec600b.js";import{f as V,r as d,_ as S,j as c,y as D,n as t,m as o,D as E,F as P,v as T,k as v,u as F,z as q,q as A,t as L}from"./index.b35b6c87.js";import"./QSpinner.cedf2831.js";import"./Ripple.5f8954d8.js";import"./dom.4a68f118.js";import"./use-dark.1516cb7d.js";import"./use-key-composition.a9714931.js";import"./uid.42677368.js";import"./focus-manager.32f8d49a.js";import"./use-form.d75ed6a7.js";import"./use-checkbox.679430af.js";import"./option-sizes.72a65bda.js";import"./use-timeout.4812ac2b.js";import"./scroll.fbb25234.js";import"./use-transition.6c02567b.js";const j=V({name:"CatSettingsEdit",props:{cat:{type:Object,required:!0}},methods:{savetxt(){const e=new FormData;e.append("name",this.edittxt),e.append("default",this.defaul.toString()),this.$fetch(`/api/v1/category/${this.cat.id}`,{method:"PATCH",body:e})}},setup(e){return{editdialog:d(!1),defaul:d(e.cat.default),edittxt:d(e.cat.name)}}}),O=T("div",{class:"text-h5"},"Edit Category",-1);function H(e,a,n,s,u,p){return c(),D(P,null,[t(i,{round:"",flat:"",icon:"edit",class:"q-ml-xl",onClick:a[0]||(a[0]=r=>e.editdialog=!0)}),t(b,{modelValue:e.editdialog,"onUpdate:modelValue":a[3]||(a[3]=r=>e.editdialog=r)},{default:o(()=>[t($,null,{default:o(()=>[t(y,null,{default:o(()=>[O]),_:1}),t(f,null,{default:o(()=>[t(k,{style:{width:"100%"},type:"text",label:"Category Name",outlined:"",modelValue:e.edittxt,"onUpdate:modelValue":a[1]||(a[1]=r=>e.edittxt=r)},null,8,["modelValue"])]),_:1}),t(f,null,{default:o(()=>[t(C,{label:"Default category when adding new manga to library",color:"blue",modelValue:e.defaul,"onUpdate:modelValue":a[2]||(a[2]=r=>e.defaul=r)},null,8,["modelValue"])]),_:1}),t(Q,{align:"right"},{default:o(()=>[E(t(i,{flat:"",label:"Save",color:"primary",onClick:e.savetxt},null,8,["onClick"]),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var z=S(j,[["render",H]]);const J=V({name:"CategoriesSettingsPage",components:{catEdit:z},methods:{myTweak(e){return{height:e?`calc(100vh - ${e}px)`:"100vh"}},moveto(e,a){const n=this.catag.findIndex(s=>s.order==e);if(n!=null){this.catag[n]!=null&&(this.catag=this.array_move(this.catag,e-1,a-1)),this.catag=this.catag.map((p,r)=>(p.order=r+1,p));const u=new FormData;u.append("from",e.toString()),u.append("to",a.toString()),this.$fetch("/api/v1/category/reorder",{method:"PATCH",body:u})}},array_move(e,a,n){if(n>=e.length){let s=n-e.length+1;for(;s--;)e.push(void 0)}return e.splice(n,0,e.splice(a,1)[0]),e},savetxt(){const e=new FormData;e.append("name",this.edittxt),e.append("default",this.defaul.toString()),this.$fetch("/api/v1/category/",{method:"POST",body:e}).then(()=>this.getcats())},getcats(){this.$fetchJSON("/api/v1/category/").then(e=>{this.catag=e.slice(1)})},delcat(e){this.$fetch(`/api/v1/category/${e}`,{method:"DELETE"}).then(()=>this.getcats())}},mounted:function(){this.getcats()},setup(){return{catag:d([]),editdialog:d(!1),newDialog:d(!1),edittxt:d(""),defaul:d(!1)}}}),G=T("div",{class:"text-h5"},"New Category",-1);function K(e,a,n,s,u,p){const r=F("catEdit");return c(),v(B,{"style-fn":e.myTweak},{default:o(()=>[t(I,{separator:"",dark:!!e.$q.dark.isActive},{default:o(()=>[(c(!0),D(P,null,q(e.catag,(l,m)=>(c(),v(f,{key:m,class:"row justify-between"},{default:o(()=>[t(h,{avatar:""},{default:o(()=>[t(_,{name:"drag_handle"})]),_:1}),t(h,null,{default:o(()=>[t(N,null,{default:o(()=>[A(L(l.name),1)]),_:2},1024)]),_:2},1024),t(i,{onClick:g=>m?e.moveto(l.order,1):"",round:"",flat:"",icon:"keyboard_double_arrow_up"},null,8,["onClick"]),t(i,{onClick:g=>m?e.moveto(l.order,l.order-1):"",round:"",flat:"",icon:"keyboard_arrow_up"},null,8,["onClick"]),t(i,{onClick:g=>m<e.catag.length-1?e.moveto(l.order,l.order+1):"",round:"",flat:"",icon:"keyboard_arrow_down"},null,8,["onClick"]),t(i,{onClick:g=>m<e.catag.length-1?e.moveto(l.order,e.catag.length):"",round:"",flat:"",icon:"keyboard_double_arrow_down"},null,8,["onClick"]),t(r,{cat:l},null,8,["cat"]),t(i,{round:"",flat:"",icon:"delete",onClick:g=>e.delcat(l.id)},null,8,["onClick"])]),_:2},1024))),128))]),_:1},8,["dark"]),t(U,{position:"bottom-right",offset:[18,18]},{default:o(()=>[t(i,{fab:"",class:"text-black",icon:"add",color:"blue",onClick:a[0]||(a[0]=l=>e.newDialog=!0)})]),_:1}),t(b,{modelValue:e.newDialog,"onUpdate:modelValue":a[3]||(a[3]=l=>e.newDialog=l)},{default:o(()=>[t($,null,{default:o(()=>[t(y,null,{default:o(()=>[G]),_:1}),t(f,null,{default:o(()=>[t(k,{style:{width:"100%"},type:"text",label:"Category Name",outlined:"",modelValue:e.edittxt,"onUpdate:modelValue":a[1]||(a[1]=l=>e.edittxt=l)},null,8,["modelValue"])]),_:1}),t(f,null,{default:o(()=>[t(C,{label:"Default category when adding new manga to library",color:"blue",modelValue:e.defaul,"onUpdate:modelValue":a[2]||(a[2]=l=>e.defaul=l)},null,8,["modelValue"])]),_:1}),t(Q,{align:"right"},{default:o(()=>[E(t(i,{flat:"",label:"Save",color:"primary",onClick:e.savetxt},null,8,["onClick"]),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["style-fn"])}var Qe=S(J,[["render",K]]);export{Qe as default};
